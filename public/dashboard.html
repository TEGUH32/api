<!DOCTYPE html>
<html lang="id" class="layout-navbar-fixed layout-menu-fixed" dir="ltr" data-bs-theme="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API Teguh - Advanced REST API Dashboard</title>
    <meta name="description" content="Advanced REST API server dengan Multi-Model AI, Social Media Downloader, dan Real-time Monitoring" />
    <meta name="keywords" content="API, REST API, AI, Deepseek, Copilot, GPT-5, Instagram Downloader, Facebook Downloader, Spotify, YouTube, Threads" />
    <link rel="icon" type="image/x-icon" href="https://img.icons8.com/color/96/000000/api.png" />
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght=300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" />
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- ApexCharts CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/apexcharts@3.41.0/dist/apexcharts.css" />
    
    <style>
        :root {
            --primary-color: #6366f1;
            --primary-dark: #4f46e5;
            --secondary-color: #8b5cf6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #3b82f6;
            --dark-color: #1e293b;
            --light-color: #f8fafc;
            --border-color: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --sidebar-width: 280px;
        }

        [data-bs-theme="dark"] {
            --primary-color: #818cf8;
            --primary-dark: #6366f1;
            --secondary-color: #a78bfa;
            --dark-color: #0f172a;
            --light-color: #1e293b;
            --border-color: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--light-color);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Layout Structure */
        .layout-wrapper {
            display: flex;
            min-height: 100vh;
        }

        .layout-container {
            display: flex;
            flex: 1;
        }

        /* Sidebar */
        #layout-menu {
            width: var(--sidebar-width);
            background: var(--dark-color);
            color: rgba(255, 255, 255, 0.9);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 1000;
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .layout-menu-expanded {
            transform: translateX(0) !important;
        }

        @media (max-width: 1199.98px) {
            #layout-menu {
                transform: translateX(-100%);
            }
        }

        /* App Brand */
        .app-brand {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 1rem;
        }

        .app-brand-link {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: white;
        }

        .app-brand-logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
        }

        .app-brand-text {
            font-size: 1.25rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .app-brand-text small {
            display: block;
            font-size: 0.75rem;
            opacity: 0.8;
            font-weight: 400;
        }

        /* Menu */
        .menu-inner {
            list-style: none;
            padding: 0 1rem;
        }

        .menu-header {
            padding: 1rem 0 0.5rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.6;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 1rem;
        }

        .menu-header:first-child {
            border-top: none;
            margin-top: 0;
        }

        .menu-item {
            margin-bottom: 2px;
        }

        .menu-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s ease;
            position: relative;
        }

        .menu-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .menu-link.active {
            background: rgba(99, 102, 241, 0.2);
            color: white;
            border-left: 4px solid var(--primary-color);
        }

        .menu-icon {
            width: 20px;
            margin-right: 12px;
            text-align: center;
            font-size: 1.125rem;
        }

        .menu-sub {
            list-style: none;
            padding-left: 1.5rem;
            margin-top: 0.25rem;
            display: none;
        }

        .menu-toggle.active + .menu-sub {
            display: block;
        }

        .menu-toggle::after {
            content: '\EA6E';
            font-family: 'remixicon';
            margin-left: auto;
            transition: transform 0.3s ease;
        }

        .menu-toggle.active::after {
            content: '\EA78';
            transform: rotate(180deg);
        }

        /* Main Content */
        .layout-page {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: margin-left 0.3s ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        @media (max-width: 1199.98px) {
            .layout-page {
                margin-left: 0;
            }
        }

        /* Navbar */
        #layout-navbar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            backdrop-filter: blur(10px);
            padding: 1rem 1.5rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Content */
        .content-wrapper {
            flex: 1;
            padding: 1.5rem;
        }

        /* Cards */
        .card {
            background: var(--light-color);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: transparent;
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .card-subtitle {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .card-body {
            padding: 1.5rem;
        }

        /* Stats Cards */
        .stat-card {
            text-align: center;
            padding: 1.5rem;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.25rem;
        }

        .stat-icon.primary { background: rgba(99, 102, 241, 0.1); color: var(--primary-color); }
        .stat-icon.success { background: rgba(16, 185, 129, 0.1); color: var(--success-color); }
        .stat-icon.warning { background: rgba(245, 158, 11, 0.1); color: var(--warning-color); }
        .stat-icon.info { background: rgba(59, 130, 246, 0.1); color: var(--info-color); }

        .stat-number {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* System Metrics */
        .metric-card {
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .metric-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .progress-thin {
            height: 6px;
            border-radius: 3px;
            background: var(--border-color);
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--primary-color);
            transition: width 1s ease;
        }

        /* Chat Interface */
        .chat-container {
            height: 300px;
            overflow-y: auto;
            padding: 1rem;
            background: var(--light-color);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .chat-message {
            max-width: 80%;
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            font-size: 0.9375rem;
            line-height: 1.4;
        }

        .chat-message.user {
            background: var(--primary-color);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .chat-message.ai {
            background: var(--border-color);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
        }

        /* Download Options */
        .download-option {
            display: block;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            text-align: center;
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.2s ease;
            margin-bottom: 0.75rem;
        }

        .download-option:hover {
            border-color: var(--primary-color);
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-2px);
        }

        .download-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        /* Media Grid */
        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 1rem;
        }

        .media-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            aspect-ratio: 1;
        }

        .media-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .media-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px;
            font-size: 0.75rem;
        }

        /* API Response */
        .api-response {
            background: var(--dark-color);
            color: #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.8125rem;
            height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }

        /* Activity List */
        .activity-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.2s ease;
        }

        .activity-item:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
            min-width: 0;
        }

        .activity-title {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.125rem;
            color: var(--text-primary);
        }

        .activity-time {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Buttons */
        .btn {
            padding: 0.625rem 1.25rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-outline-primary {
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            background: transparent;
        }

        .btn-outline-primary:hover {
            background: var(--primary-color);
            color: white;
        }

        /* Form Controls */
        .form-control, .form-select {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.625rem 1rem;
            background: var(--light-color);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            outline: none;
        }

        /* Badges */
        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .bg-primary { background: var(--primary-color); }
        .bg-success { background: var(--success-color); }
        .bg-danger { background: var(--danger-color); }
        .bg-warning { background: var(--warning-color); }
        .bg-info { background: var(--info-color); }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .fade-in {
            animation: fadeIn 0.3s ease;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Loading States */
        .loading {
            position: relative;
            opacity: 0.6;
            pointer-events: none;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid var(--border-color);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Mobile Toggle */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1001;
            background: var(--primary-color);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.25rem;
        }

        @media (max-width: 1199.98px) {
            .mobile-toggle {
                display: flex;
            }
        }

        /* Footer */
        .footer {
            background: var(--light-color);
            border-top: 1px solid var(--border-color);
            padding: 1.5rem;
            margin-top: auto;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-secondary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-primary);
        }

        /* Utility Classes */
        .text-primary { color: var(--primary-color) !important; }
        .text-success { color: var(--success-color) !important; }
        .text-danger { color: var(--danger-color) !important; }
        .text-warning { color: var(--warning-color) !important; }
        .text-muted { color: var(--text-secondary) !important; }

        .bg-light { background: var(--light-color) !important; }
        .bg-dark { background: var(--dark-color) !important; }

        .border { border: 1px solid var(--border-color) !important; }
        .rounded { border-radius: 8px !important; }

        .shadow-sm { box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important; }
        .shadow { box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1) !important; }

        /* Responsive Grid */
        @media (max-width: 768px) {
            .content-wrapper {
                padding: 1rem;
            }
            
            .card-body {
                padding: 1rem;
            }
            
            .stat-number {
                font-size: 1.5rem;
            }
            
            .chat-container {
                height: 250px;
            }
            
            .media-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Mobile Toggle -->
    <button class="mobile-toggle" id="mobileToggle">
        <i class="ri-menu-line"></i>
    </button>

    <!-- Layout Container -->
    <div class="layout-wrapper">
        <!-- Sidebar Menu -->
        <aside id="layout-menu" class="layout-menu">
            <div class="app-brand">
                <a href="/" class="app-brand-link">
                    <div class="app-brand-logo">
                        <i class="ri-server-line"></i>
                    </div>
                    <div class="app-brand-text">
                        API Teguh
                        <small>v3.6.0</small>
                    </div>
                </a>
            </div>

            <!-- Menu Items -->
            <ul class="menu-inner">
                <!-- Dashboard -->
                <li class="menu-item active">
                    <a href="dashboard.html" class="menu-link">
                        <i class="menu-icon ri-dashboard-line"></i>
                        <span>Dashboard</span>
                    </a>
                </li>

                <!-- Home -->
                <li class="menu-item">
                    <a href="index.html" class="menu-link">
                        <i class="menu-icon ri-home-line"></i>
                        <span>Home</span>
                    </a>
                </li>

                <!-- AI Endpoints -->
                <li class="menu-header">
                    AI Endpoints
                </li>
                <li class="menu-item">
                    <a href="javascript:void(0)" class="menu-link menu-toggle">
                        <i class="menu-icon ri-robot-line"></i>
                        <span>AI Models</span>
                    </a>
                    <ul class="menu-sub">
                        <li><a href="/api/deepseek?q=Hello" target="_blank">Deepseek AI</a></li>
                        <li><a href="/api/copilot?text=Hello" target="_blank">Copilot AI</a></li>
                        <li><a href="/api/gpt5?text=Hello" target="_blank">GPT-5 AI</a></li>
                        <li><a href="/api/ai/chat?text=Hello&model=auto" target="_blank">Multi-Model Chat</a></li>
                    </ul>
                </li>

                <!-- Social Media Downloaders -->
                <li class="menu-item">
                    <a href="javascript:void(0)" class="menu-link menu-toggle">
                        <i class="menu-icon ri-download-cloud-line"></i>
                        <span>Social Media</span>
                    </a>
                    <ul class="menu-sub">
                        <li><a href="/api/instagram?url=" target="_blank">Instagram</a></li>
                        <li><a href="/api/facebook?url=" target="_blank">Facebook</a></li>
                        <li><a href="/api/threads?url=" target="_blank">Threads</a></li>
                        <li><a href="/api/social/media?url=" target="_blank">Social Tools</a></li>
                    </ul>
                </li>

                <!-- Audio & Video -->
                <li class="menu-item">
                    <a href="javascript:void(0)" class="menu-link menu-toggle">
                        <i class="menu-icon ri-music-line"></i>
                        <span>Audio & Video</span>
                    </a>
                    <ul class="menu-sub">
                        <li><a href="/api/spotify?url=" target="_blank">Spotify</a></li>
                        <li><a href="/api/youtube/audio?url=" target="_blank">YouTube Audio</a></li>
                        <li><a href="/api/youtube/video?url=" target="_blank">YouTube Video</a></li>
                    </ul>
                </li>

                <!-- Unified Downloader -->
                <li class="menu-item">
                    <a href="/api/download?url=" target="_blank" class="menu-link">
                        <i class="menu-icon ri-download-line"></i>
                        <span>Unified Downloader</span>
                    </a>
                </li>

                <!-- Server Tools -->
                <li class="menu-item">
                    <a href="javascript:void(0)" class="menu-link menu-toggle">
                        <i class="menu-icon ri-tools-line"></i>
                        <span>Server Tools</span>
                    </a>
                    <ul class="menu-sub">
                        <li><a href="/api/status" target="_blank">Server Status</a></li>
                        <li><a href="/api/ping" target="_blank">Ping Test</a></li>
                        <li><a href="/api/health" target="_blank">Health Check</a></li>
                        <li><a href="/api/info" target="_blank">API Info</a></li>
                    </ul>
                </li>

                <!-- Quick Actions -->
                <li class="menu-header">
                    Quick Actions
                </li>
                <li class="menu-item">
                    <a href="#ai-chat" class="menu-link" onclick="scrollToSection('ai-chat')">
                        <i class="menu-icon ri-chat-1-line"></i>
                        <span>AI Chat</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#downloader" class="menu-link" onclick="scrollToSection('downloader')">
                        <i class="menu-icon ri-download-line"></i>
                        <span>Downloader</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#api-tester" class="menu-link" onclick="scrollToSection('api-tester')">
                        <i class="menu-icon ri-code-s-slash-line"></i>
                        <span>API Tester</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#threads-downloader" class="menu-link" onclick="scrollToSection('threads-downloader')">
                        <i class="menu-icon ri-threads-line"></i>
                        <span>Threads Download</span>
                    </a>
                </li>

                <!-- Support -->
                <li class="menu-header">
                    Support
                </li>
                <li class="menu-item">
                    <a href="mailto:support@api-teguh.com" class="menu-link">
                        <i class="menu-icon ri-customer-service-line"></i>
                        <span>Contact Support</span>
                    </a>
                </li>

                <!-- Server Status -->
                <div class="menu-header">
                    Server Status
                </div>
                <li class="menu-item">
                    <div class="menu-link">
                        <div class="d-flex align-items-center">
                            <div class="pulse" id="statusIndicator" style="width: 8px; height: 8px; border-radius: 50%; background: var(--success-color); margin-right: 8px;"></div>
                            <div>
                                <div class="small">Server Status</div>
                                <div class="small text-muted" id="serverUptime">Checking...</div>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <div class="layout-page">
            <!-- Navbar -->
            <nav id="layout-navbar">
                <div class="navbar-content">
                    <div class="d-flex align-items-center">
                        <h4 class="mb-0 text-white">Dashboard Overview</h4>
                    </div>
                    <div class="d-flex align-items-center gap-3">
                        <button class="btn btn-outline-light btn-sm" id="refreshBtn">
                            <i class="ri-refresh-line"></i> Refresh
                        </button>
                        <button class="btn btn-light btn-sm" id="themeToggle">
                            <i class="ri-sun-line" id="themeIcon"></i>
                        </button>
                        <div class="dropdown">
                            <button class="btn btn-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                <i class="ri-user-line"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="index.html">Back to Home</a></li>
                                <li><a class="dropdown-item" href="/api/info" target="_blank">Documentation</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="javascript:void(0)" onclick="logout()">Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Content -->
            <div class="content-wrapper">
                <!-- Stats Overview -->
                <div class="row mb-4">
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="card stat-card fade-in">
                            <div class="stat-icon primary">
                                <i class="ri-plug-line"></i>
                            </div>
                            <div class="stat-number" id="endpointsCount">14</div>
                            <div class="stat-label">API Endpoints</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="card stat-card fade-in">
                            <div class="stat-icon success">
                                <i class="ri-checkbox-circle-line"></i>
                            </div>
                            <div class="stat-number" id="successRate">99.9%</div>
                            <div class="stat-label">Success Rate</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="card stat-card fade-in">
                            <div class="stat-icon warning">
                                <i class="ri-time-line"></i>
                            </div>
                            <div class="stat-number" id="responseTime">32ms</div>
                            <div class="stat-label">Avg Response</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="card stat-card fade-in">
                            <div class="stat-icon info">
                                <i class="ri-user-line"></i>
                            </div>
                            <div class="stat-number" id="activeUsers">156</div>
                            <div class="stat-label">Active Users</div>
                        </div>
                    </div>
                </div>

                <!-- System Monitoring -->
                <div class="row mb-4">
                    <div class="col-lg-8 mb-4">
                        <div class="card h-100 fade-in">
                            <div class="card-header">
                                <h5 class="card-title">System Monitoring</h5>
                                <p class="card-subtitle">Real-time server metrics</p>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="metric-card">
                                            <div class="metric-value" id="cpuUsage">24.5%</div>
                                            <div class="metric-label">CPU Usage</div>
                                            <div class="progress-thin">
                                                <div class="progress-bar" id="cpuBar" style="width: 24.5%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <div class="metric-card">
                                            <div class="metric-value" id="memoryUsage">67.2%</div>
                                            <div class="metric-label">Memory Usage</div>
                                            <div class="progress-thin">
                                                <div class="progress-bar" id="memoryBar" style="width: 67.2%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="metric-card">
                                            <div class="metric-value" id="uptimeValue">15d 7h</div>
                                            <div class="metric-label">Server Uptime</div>
                                            <div class="mt-2">
                                                <span class="badge bg-success">Online</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="metric-card">
                                            <div class="metric-value" id="totalRequests">15.8K</div>
                                            <div class="metric-label">Total Requests</div>
                                            <div class="mt-2">
                                                <span class="badge bg-primary">Today: 387</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 mb-4">
                        <div class="card h-100 fade-in">
                            <div class="card-header">
                                <h5 class="card-title">Endpoint Status</h5>
                                <p class="card-subtitle">API health monitoring</p>
                            </div>
                            <div class="card-body">
                                <div class="activity-list" id="endpointStatus">
                                    <!-- Status akan di-load oleh JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Chat Section -->
                <div class="row mb-4" id="ai-chat">
                    <div class="col-12">
                        <div class="card fade-in">
                            <div class="card-header">
                                <h5 class="card-title">AI Chat Assistant</h5>
                                <p class="card-subtitle">Test multiple AI models in real-time</p>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <div class="mb-3">
                                            <label class="form-label">Select AI Model</label>
                                            <div class="d-flex flex-wrap gap-2">
                                                <button class="btn btn-outline-primary active" data-model="auto">Auto</button>
                                                <button class="btn btn-outline-primary" data-model="deepseek">Deepseek</button>
                                                <button class="btn btn-outline-primary" data-model="copilot">Copilot</button>
                                                <button class="btn btn-outline-primary" data-model="gpt5">GPT-5</button>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Your Message</label>
                                            <textarea class="form-control" id="aiMessage" rows="4" placeholder="Type your message here...">Hello! How can you help me today?</textarea>
                                        </div>
                                        <button class="btn btn-primary w-100" id="sendAiBtn">
                                            <i class="ri-send-plane-line me-2"></i>Send Message
                                        </button>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card h-100">
                                            <div class="card-header">
                                                <h6 class="mb-0">Chat Response</h6>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="chat-container" id="chatContainer">
                                                    <div class="chat-message ai">
                                                        Hello! I'm your AI assistant. I can help you with questions using multiple AI models. Select a model and type your message to start chatting!
                                                    </div>
                                                </div>
                                                <div class="p-3 border-top">
                                                    <small class="text-muted" id="responseInfo">Ready to chat...</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Downloader Section -->
                <div class="row mb-4" id="downloader">
                    <div class="col-12">
                        <div class="card fade-in">
                            <div class="card-header">
                                <h5 class="card-title">Social Media Downloader</h5>
                                <p class="card-subtitle">Download videos from Instagram, Facebook, and Threads</p>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="mb-3">
                                            <label class="form-label">Platform</label>
                                            <select class="form-select" id="downloadPlatform">
                                                <option value="auto">Auto Detect</option>
                                                <option value="instagram">Instagram</option>
                                                <option value="facebook">Facebook</option>
                                                <option value="threads">Threads</option>
                                                <option value="youtube">YouTube</option>
                                                <option value="spotify">Spotify</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Media URL</label>
                                            <input type="text" class="form-control" id="mediaUrl" placeholder="https://www.instagram.com/p/...">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Quality (Optional)</label>
                                            <select class="form-select" id="downloadQuality">
                                                <option value="best">Best Quality</option>
                                                <option value="high">High</option>
                                                <option value="medium">Medium</option>
                                                <option value="low">Low</option>
                                                <option value="360">360p</option>
                                                <option value="720">720p</option>
                                                <option value="1080">1080p</option>
                                            </select>
                                        </div>
                                        <button class="btn btn-primary w-100" id="downloadBtn">
                                            <i class="ri-download-line me-2"></i>Download Media
                                        </button>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card h-100">
                                            <div class="card-header">
                                                <h6 class="mb-0">Download Result</h6>
                                            </div>
                                            <div class="card-body">
                                                <div id="downloadResult" class="text-center py-5">
                                                    <i class="ri-download-cloud-line text-muted" style="font-size: 3rem;"></i>
                                                    <p class="text-muted mt-3">Enter a URL to download media</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Threads Downloader Section -->
                <div class="row mb-4" id="threads-downloader">
                    <div class="col-12">
                        <div class="card fade-in">
                            <div class="card-header">
                                <h5 class="card-title">Threads Downloader</h5>
                                <p class="card-subtitle">Download images from Threads posts</p>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <div class="mb-3">
                                            <label class="form-label">Threads URL</label>
                                            <input type="text" class="form-control" id="threadsUrl" placeholder="https://www.threads.com/@username/post/...">
                                            <small class="text-muted">Example: https://www.threads.com/@mamanyahyaali/post/DOslYoXAVSs</small>
                                        </div>
                                        <button class="btn btn-primary w-100" id="threadsDownloadBtn">
                                            <i class="ri-threads-line me-2"></i>Download Threads Images
                                        </button>
                                        <div class="mt-3">
                                            <small class="text-muted">
                                                <i class="ri-information-line me-1"></i>
                                                Threads downloader supports multi-image posts (carousels)
                                            </small>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card h-100">
                                            <div class="card-header">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h6 class="mb-0">Threads Images</h6>
                                                    <small class="text-muted" id="threadsCount">0 images</small>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <div id="threadsResult" class="text-center py-5">
                                                    <i class="ri-threads-line text-muted" style="font-size: 3rem;"></i>
                                                    <p class="text-muted mt-3">Enter a Threads URL to download images</p>
                                                </div>
                                                <div class="media-grid" id="threadsGallery" style="display: none;"></div>
                                                <div class="mt-3" id="threadsInfo" style="display: none;">
                                                    <div class="alert alert-info">
                                                        <i class="ri-information-line me-2"></i>
                                                        Click on any image to download it directly
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- API Tester -->
                <div class="row mb-4" id="api-tester">
                    <div class="col-12">
                        <div class="card fade-in">
                            <div class="card-header">
                                <h5 class="card-title">API Tester</h5>
                                <p class="card-subtitle">Test API endpoints directly</p>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <div class="mb-3">
                                            <label class="form-label">Endpoint</label>
                                            <select class="form-select" id="endpointSelect">
                                                <option value="/api/deepseek?q=">Deepseek AI</option>
                                                <option value="/api/copilot?text=">Copilot AI</option>
                                                <option value="/api/gpt5?text=">GPT-5 AI</option>
                                                <option value="/api/instagram?url=">Instagram</option>
                                                <option value="/api/facebook?url=">Facebook</option>
                                                <option value="/api/threads?url=">Threads</option>
                                                <option value="/api/spotify?url=">Spotify</option>
                                                <option value="/api/youtube/audio?url=">YouTube Audio</option>
                                                <option value="/api/youtube/video?url=">YouTube Video</option>
                                                <option value="/api/status">Server Status</option>
                                                <option value="/api/health">Health Check</option>
                                                <option value="/api/info">API Info</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Parameter Value</label>
                                            <input type="text" class="form-control" id="paramValue" placeholder="Enter value...">
                                        </div>
                                        <div class="d-grid gap-2">
                                            <button class="btn btn-primary" id="testApiBtn">
                                                <i class="ri-play-line me-2"></i>Test Endpoint
                                            </button>
                                            <button class="btn btn-outline-primary" id="copyUrlBtn">
                                                <i class="ri-clipboard-line me-2"></i>Copy URL
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card h-100">
                                            <div class="card-header">
                                                <h6 class="mb-0">API Response</h6>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="api-response" id="apiResponse">
{
  "status": true,
  "message": "Select an endpoint and click 'Test Endpoint'",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
                                                </div>
                                                <div class="p-3 border-top">
                                                    <div class="row">
                                                        <div class="col">
                                                            <small class="text-muted" id="responseStatus">Status: Ready</small>
                                                        </div>
                                                        <div class="col text-end">
                                                            <small class="text-muted" id="apiResponseTime">Time: --</small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Activity Log -->
                <div class="row">
                    <div class="col-12">
                        <div class="card fade-in">
                            <div class="card-header">
                                <h5 class="card-title">Recent Activity</h5>
                                <p class="card-subtitle">Latest API requests and events</p>
                            </div>
                            <div class="card-body">
                                <div class="activity-list" id="activityLog">
                                    <!-- Activities will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="footer">
                <div class="container-fluid">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <div class="text-muted">
                                 2024 API Teguh v3.6.0  Built by Muhammad Teguh
                            </div>
                        </div>
                        <div class="col-md-6 text-end">
                            <div class="d-flex justify-content-end gap-3">
                                <a href="index.html" class="text-muted text-decoration-none">Home</a>
                                <a href="dashboard.html" class="text-muted text-decoration-none">Dashboard</a>
                                <a href="/api/info" target="_blank" class="text-muted text-decoration-none">Documentation</a>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Global State
        const state = {
            currentModel: 'auto',
            chatHistory: [],
            activities: [],
            refreshInterval: null,
            serverStatus: 'checking'
        };

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            initializeMenu();
            initializeEventListeners();
            loadInitialData();
            startAutoRefresh();
            
            console.log('Dashboard v3.6.0 initialized successfully');
        });

        // Theme Management
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
            
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-bs-theme', theme);
            const icon = document.getElementById('themeIcon');
            icon.className = theme === 'dark' ? 'ri-moon-line' : 'ri-sun-line';
            localStorage.setItem('theme', theme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-bs-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            setTheme(newTheme);
        }

        // Menu Management
        function initializeMenu() {
            const mobileToggle = document.getElementById('mobileToggle');
            const menu = document.getElementById('layout-menu');
            
            mobileToggle.addEventListener('click', function() {
                menu.classList.toggle('layout-menu-expanded');
            });
            
            // Close menu when clicking outside on mobile
            document.addEventListener('click', function(event) {
                if (window.innerWidth < 1200) {
                    if (!menu.contains(event.target) && !mobileToggle.contains(event.target)) {
                        menu.classList.remove('layout-menu-expanded');
                    }
                }
            });
            
            // Menu toggle functionality
            document.querySelectorAll('.menu-toggle').forEach(toggle => {
                toggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    this.classList.toggle('active');
                });
            });
        }

        // Event Listeners
        function initializeEventListeners() {
            // AI Model selection
            document.querySelectorAll('[data-model]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-model]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    state.currentModel = this.dataset.model;
                    addActivity(`Switched to ${state.currentModel} model`, 'ai');
                });
            });
            
            // AI Chat
            document.getElementById('sendAiBtn').addEventListener('click', sendAiMessage);
            document.getElementById('aiMessage').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendAiMessage();
                }
            });
            
            // Downloader
            document.getElementById('downloadBtn').addEventListener('click', processDownload);
            document.getElementById('mediaUrl').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') processDownload();
            });
            
            // Threads Downloader
            document.getElementById('threadsDownloadBtn').addEventListener('click', processThreadsDownload);
            document.getElementById('threadsUrl').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') processThreadsDownload();
            });
            
            // API Tester
            document.getElementById('testApiBtn').addEventListener('click', testApiEndpoint);
            document.getElementById('copyUrlBtn').addEventListener('click', copyApiUrl);
            document.getElementById('endpointSelect').addEventListener('change', updateParamPlaceholder);
            
            // Refresh button
            document.getElementById('refreshBtn').addEventListener('click', refreshDashboard);
        }

        // Load Initial Data
        function loadInitialData() {
            loadServerStatus();
            loadEndpointStatus();
            updateSystemMetrics();
            loadActivityLog();
            
            // Add initial activity
            addActivity('Dashboard v3.6.0 loaded successfully', 'system');
            addActivity('Threads downloader now available', 'download');
        }

        // Auto Refresh
        function startAutoRefresh() {
            if (state.refreshInterval) clearInterval(state.refreshInterval);
            
            state.refreshInterval = setInterval(() => {
                loadServerStatus();
                updateSystemMetrics();
            }, 10000); // Refresh every 10 seconds
        }

        // Server Status
        async function loadServerStatus() {
            try {
                const response = await fetch('/api/status');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                
                if (data.status) {
                    updateServerStatusUI(data.data);
                    state.serverStatus = 'online';
                }
            } catch (error) {
                console.warn('Server status check failed:', error);
                state.serverStatus = 'offline';
                updateServerStatusUI(null);
            }
        }

        function updateServerStatusUI(data) {
            const indicator = document.getElementById('statusIndicator');
            const uptimeElement = document.getElementById('serverUptime');
            
            if (data) {
                indicator.style.background = 'var(--success-color)';
                
                // Format uptime
                const uptime = data.server.uptime;
                const days = Math.floor(uptime / 86400);
                const hours = Math.floor((uptime % 86400) / 3600);
                const minutes = Math.floor((uptime % 3600) / 60);
                uptimeElement.textContent = `${days}d ${hours}h ${minutes}m`;
                
                // Update system metrics
                document.getElementById('cpuUsage').textContent = `${data.memory.usage_percent}%`;
                document.getElementById('cpuBar').style.width = `${data.memory.usage_percent}%`;
                document.getElementById('memoryUsage').textContent = `${data.memory.usage_percent}%`;
                document.getElementById('memoryBar').style.width = `${data.memory.usage_percent}%`;
            } else {
                indicator.style.background = 'var(--danger-color)';
                uptimeElement.textContent = 'Offline';
            }
        }

        // Endpoint Status
        async function loadEndpointStatus() {
            const endpoints = [
                { name: 'Deepseek AI', path: '/api/deepseek?q=test', method: 'GET' },
                { name: 'Copilot AI', path: '/api/copilot?text=test', method: 'GET' },
                { name: 'GPT-5 AI', path: '/api/gpt5?text=test', method: 'GET' },
                { name: 'Instagram', path: '/api/instagram?url=', method: 'GET' },
                { name: 'Facebook', path: '/api/facebook?url=', method: 'GET' },
                { name: 'Threads', path: '/api/threads?url=', method: 'GET' },
                { name: 'Spotify', path: '/api/spotify?url=https://open.spotify.com/track/3k68kVFWTTBP0Jb4LOzCax', method: 'GET' },
                { name: 'YouTube Audio', path: '/api/youtube/audio?url=https://youtu.be/HWjCStB6k4o', method: 'GET' },
                { name: 'YouTube Video', path: '/api/youtube/video?url=https://youtu.be/HWjCStB6k4o', method: 'GET' },
                { name: 'Server Status', path: '/api/status', method: 'GET' }
            ];
            
            let html = '';
            
            for (const endpoint of endpoints) {
                try {
                    const startTime = Date.now();
                    const response = await fetch(endpoint.path);
                    const endTime = Date.now();
                    
                    const status = response.status;
                    const responseTime = endTime - startTime;
                    const statusClass = status === 200 ? 'success' : 'warning';
                    const statusText = status === 200 ? 'Online' : 'Error';
                    
                    html += `
                        <div class="activity-item">
                            <div class="activity-icon bg-${statusClass}">
                                <i class="ri-plug-line"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">${endpoint.name}</div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <small class="text-muted">${endpoint.method} ${endpoint.path.split('?')[0]}</small>
                                    <div>
                                        <small class="text-muted me-2">${responseTime}ms</small>
                                        <span class="badge bg-${statusClass}">${statusText}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } catch (error) {
                    html += `
                        <div class="activity-item">
                            <div class="activity-icon bg-danger">
                                <i class="ri-plug-line"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">${endpoint.name}</div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <small class="text-muted">${endpoint.method} ${endpoint.path.split('?')[0]}</small>
                                    <span class="badge bg-danger">Offline</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }
            
            document.getElementById('endpointStatus').innerHTML = html;
            addActivity('Endpoint status updated', 'system');
        }

        // System Metrics
        function updateSystemMetrics() {
            // Simulate metrics update
            const cpu = Math.floor(Math.random() * 30) + 20;
            const memory = Math.floor(Math.random() * 30) + 40;
            const requests = Math.floor(Math.random() * 1000) + 500;
            
            document.getElementById('cpuUsage').textContent = `${cpu}%`;
            document.getElementById('cpuBar').style.width = `${cpu}%`;
            document.getElementById('memoryUsage').textContent = `${memory}%`;
            document.getElementById('memoryBar').style.width = `${memory}%`;
            document.getElementById('totalRequests').textContent = `${(requests / 1000).toFixed(1)}K`;
            
            // Update response time
            const responseTime = Math.floor(Math.random() * 50) + 20;
            document.getElementById('responseTime').textContent = `${responseTime}ms`;
        }

        // AI Chat
        async function sendAiMessage() {
            const input = document.getElementById('aiMessage');
            const message = input.value.trim();
            
            if (!message) {
                alert('Please enter a message');
                return;
            }
            
            // Disable button and show loading
            const btn = document.getElementById('sendAiBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="ri-loader-4-line spin me-2"></i>Sending...';
            btn.disabled = true;
            
            // Add user message
            addChatMessage('user', message);
            input.value = '';
            
            // Show thinking message
            const thinkingId = addChatMessage('ai', 'Thinking...', true);
            
            try {
                let apiUrl;
                switch(state.currentModel) {
                    case 'deepseek':
                        apiUrl = `/api/deepseek?q=${encodeURIComponent(message)}`;
                        break;
                    case 'copilot':
                        apiUrl = `/api/copilot?text=${encodeURIComponent(message)}`;
                        break;
                    case 'gpt5':
                        apiUrl = `/api/gpt5?text=${encodeURIComponent(message)}`;
                        break;
                    default:
                        apiUrl = `/api/ai/chat?text=${encodeURIComponent(message)}&model=auto`;
                }
                
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                // Remove thinking message
                document.getElementById(thinkingId)?.remove();
                
                // Add AI response
                let aiResponse;
                if (state.currentModel === 'deepseek') {
                    aiResponse = data.data?.response || data.message;
                } else {
                    aiResponse = data.result || data.data?.result || data.message;
                }
                
                addChatMessage('ai', aiResponse);
                updateResponseInfo(`Response from ${state.currentModel} model`);
                
                // Add to history
                state.chatHistory.push({
                    user: message,
                    ai: aiResponse,
                    model: state.currentModel,
                    timestamp: new Date()
                });
                
                addActivity(`AI chat: ${message.substring(0, 30)}...`, 'ai');
                
            } catch (error) {
                document.getElementById(thinkingId)?.remove();
                addChatMessage('ai', `Error: ${error.message}. Please try again.`);
                updateResponseInfo('Error occurred');
                addActivity('AI chat failed', 'error');
            } finally {
                // Restore button
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        function addChatMessage(sender, content, isThinking = false) {
            const container = document.getElementById('chatContainer');
            const messageId = 'msg-' + Date.now();
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;
            messageDiv.id = messageId;
            
            if (isThinking) {
                messageDiv.innerHTML = `
                    <div class="d-flex align-items-center">
                        <div class="spinner-border spinner-border-sm text-primary me-2" role="status"></div>
                        ${content}
                    </div>
                `;
            } else {
                messageDiv.textContent = content;
            }
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
            
            return messageId;
        }

        function updateResponseInfo(text) {
            document.getElementById('responseInfo').textContent = text;
        }

        // Downloader
        async function processDownload() {
            const urlInput = document.getElementById('mediaUrl');
            const platform = document.getElementById('downloadPlatform').value;
            const quality = document.getElementById('downloadQuality').value;
            const url = urlInput.value.trim();
            
            if (!url) {
                alert('Please enter a URL');
                return;
            }
            
            // Show loading
            const resultDiv = document.getElementById('downloadResult');
            resultDiv.innerHTML = `
                <div class="text-center py-4">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p class="mt-3">Processing download...</p>
                </div>
            `;
            
            // Disable button
            const btn = document.getElementById('downloadBtn');
            btn.disabled = true;
            
            try {
                let apiUrl;
                if (platform === 'auto') {
                    apiUrl = `/api/download?url=${encodeURIComponent(url)}&quality=${quality}`;
                } else if (platform === 'youtube') {
                    apiUrl = `/api/youtube/video?url=${encodeURIComponent(url)}&quality=${quality}`;
                } else if (platform === 'spotify') {
                    apiUrl = `/api/spotify?url=${encodeURIComponent(url)}&quality=${quality}`;
                } else {
                    apiUrl = `/api/${platform}?url=${encodeURIComponent(url)}`;
                }
                
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                if (data.status) {
                    showDownloadResult(data, platform);
                    addActivity(`Download from ${platform}: ${url.substring(0, 30)}...`, 'download');
                } else {
                    throw new Error(data.message || 'Download failed');
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="text-center py-4">
                        <i class="ri-error-warning-line text-danger" style="font-size: 3rem;"></i>
                        <h6 class="mt-3">Download Failed</h6>
                        <p class="text-muted">${error.message}</p>
                    </div>
                `;
                addActivity(`Download failed: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        function showDownloadResult(data, platform) {
            const result = data.result || data.data;
            let html = '<div class="text-start">';
            
            html += '<div class="alert alert-success mb-3">Download successful!</div>';
            
            if (result.title || result.metadata?.title) {
                html += `<p><strong>Title:</strong> ${result.title || result.metadata.title}</p>`;
            }
            
            if (result.durasi || result.metadata?.duration) {
                html += `<p><strong>Duration:</strong> ${result.durasi || result.metadata.duration.timestamp}</p>`;
            }
            
            if (result.thumbnail || result.metadata?.thumbnail) {
                html += `
                    <div class="mb-3">
                        <img src="${result.thumbnail || result.metadata.thumbnail}" alt="Thumbnail" class="img-fluid rounded" style="max-height: 120px;">
                    </div>
                `;
            }
            
            if (result.download || result.download?.url) {
                html += '<div class="mt-3"><strong>Download Options:</strong></div>';
                
                if (result.download.hd) {
                    html += `
                        <a href="${result.download.hd}" target="_blank" class="download-option">
                            <i class="download-icon ri-hd-line"></i>
                            <div>HD Quality</div>
                            <small class="text-muted">High Definition</small>
                        </a>
                    `;
                }
                
                if (result.download.sd) {
                    html += `
                        <a href="${result.download.sd}" target="_blank" class="download-option">
                            <i class="download-icon ri-video-line"></i>
                            <div>SD Quality</div>
                            <small class="text-muted">Standard Definition</small>
                        </a>
                    `;
                }
                
                if (result.download.url) {
                    html += `
                        <a href="${result.download.url}" target="_blank" class="download-option">
                            <i class="download-icon ri-download-line"></i>
                            <div>Download File</div>
                            <small class="text-muted">${result.download.quality || 'Best Quality'}</small>
                        </a>
                    `;
                }
            }
            
            html += '</div>';
            document.getElementById('downloadResult').innerHTML = html;
        }

        // Threads Downloader
        async function processThreadsDownload() {
            const urlInput = document.getElementById('threadsUrl');
            const url = urlInput.value.trim();
            
            if (!url) {
                alert('Please enter a Threads URL');
                return;
            }
            
            // Validate URL
            if (!url.includes('threads.com') && !url.includes('threads.net')) {
                alert('Please enter a valid Threads URL');
                return;
            }
            
            // Show loading
            const btn = document.getElementById('threadsDownloadBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="ri-loader-4-line spin me-2"></i>Downloading...';
            btn.disabled = true;
            
            const resultDiv = document.getElementById('threadsResult');
            const galleryDiv = document.getElementById('threadsGallery');
            const infoDiv = document.getElementById('threadsInfo');
            
            resultDiv.innerHTML = `
                <div class="text-center py-4">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p class="mt-3">Downloading Threads images...</p>
                </div>
            `;
            galleryDiv.style.display = 'none';
            infoDiv.style.display = 'none';
            
            try {
                const apiUrl = `/api/threads?url=${encodeURIComponent(url)}`;
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                if (data.status && data.result?.media) {
                    displayThreadsImages(data.result.media);
                    addActivity(`Threads download: ${url.substring(0, 30)}...`, 'download');
                } else {
                    throw new Error(data.message || 'No images found');
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="text-center py-4">
                        <i class="ri-error-warning-line text-danger" style="font-size: 3rem;"></i>
                        <h6 class="mt-3">Download Failed</h6>
                        <p class="text-muted">${error.message}</p>
                    </div>
                `;
                addActivity(`Threads download failed: ${error.message}`, 'error');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        function displayThreadsImages(media) {
            const resultDiv = document.getElementById('threadsResult');
            const galleryDiv = document.getElementById('threadsGallery');
            const infoDiv = document.getElementById('threadsInfo');
            const countDiv = document.getElementById('threadsCount');
            
            if (!media || media.length === 0) {
                resultDiv.innerHTML = `
                    <div class="text-center py-4">
                        <i class="ri-image-line text-muted" style="font-size: 3rem;"></i>
                        <p class="mt-3">No images found in this Threads post</p>
                    </div>
                `;
                return;
            }
            
            // Update count
            countDiv.textContent = `${media.length} images`;
            
            // Hide result message and show gallery
            resultDiv.style.display = 'none';
            
            // Build gallery
            let galleryHTML = '';
            media.forEach((item, index) => {
                galleryHTML += `
                    <div class="media-item">
                        <a href="${item.url}" target="_blank" download="threads-image-${index + 1}.jpg">
                            <img src="${item.thumb || item.url}" alt="Threads Image ${index + 1}" loading="lazy">
                            <div class="media-overlay">
                                <div class="d-flex justify-content-between">
                                    <span>Image ${index + 1}</span>
                                    <span><i class="ri-download-line"></i></span>
                                </div>
                            </div>
                        </a>
                    </div>
                `;
            });
            
            galleryDiv.innerHTML = galleryHTML;
            galleryDiv.style.display = 'grid';
            infoDiv.style.display = 'block';
        }

        // API Tester
        function updateParamPlaceholder() {
            const select = document.getElementById('endpointSelect');
            const paramInput = document.getElementById('paramValue');
            const endpoint = select.value;
            
            if (endpoint.includes('status') || endpoint.includes('health') || endpoint.includes('info')) {
                paramInput.style.display = 'none';
                paramInput.previousElementSibling.style.display = 'none';
            } else {
                paramInput.style.display = 'block';
                paramInput.previousElementSibling.style.display = 'block';
                
                // Set placeholder based on endpoint
                if (endpoint.includes('deepseek')) {
                    paramInput.placeholder = 'Enter your question...';
                } else if (endpoint.includes('copilot') || endpoint.includes('gpt5')) {
                    paramInput.placeholder = 'Enter your message...';
                } else if (endpoint.includes('threads')) {
                    paramInput.placeholder = 'Enter Threads post URL...';
                } else if (endpoint.includes('youtube')) {
                    paramInput.placeholder = 'Enter YouTube URL...';
                } else if (endpoint.includes('spotify')) {
                    paramInput.placeholder = 'Enter Spotify track URL...';
                } else {
                    paramInput.placeholder = 'Enter URL...';
                }
            }
        }

        async function testApiEndpoint() {
            const select = document.getElementById('endpointSelect');
            const paramInput = document.getElementById('paramValue');
            let endpoint = select.value;
            
            // Validate
            if (!endpoint.includes('status') && !endpoint.includes('health') && !endpoint.includes('info') && !paramInput.value.trim()) {
                alert('Please enter a parameter value');
                return;
            }
            
            // Build URL
            if (!endpoint.includes('status') && !endpoint.includes('health') && !endpoint.includes('info')) {
                endpoint += encodeURIComponent(paramInput.value);
            }
            
            // Update UI
            const testBtn = document.getElementById('testApiBtn');
            const originalText = testBtn.innerHTML;
            testBtn.innerHTML = '<i class="ri-loader-4-line spin me-2"></i>Testing...';
            testBtn.disabled = true;
            
            const responseDiv = document.getElementById('apiResponse');
            const statusEl = document.getElementById('responseStatus');
            const timeEl = document.getElementById('apiResponseTime');
            
            responseDiv.textContent = 'Testing endpoint...';
            statusEl.textContent = 'Status: Testing...';
            timeEl.textContent = 'Time: --';
            
            try {
                const startTime = Date.now();
                const response = await fetch(endpoint);
                const endTime = Date.now();
                
                const data = await response.json();
                const responseTime = endTime - startTime;
                
                // Format JSON
                responseDiv.textContent = JSON.stringify(data, null, 2);
                statusEl.textContent = `Status: ${response.status} ${response.ok ? '' : ''}`;
                timeEl.textContent = `Time: ${responseTime}ms`;
                
                addActivity(`Tested ${endpoint.split('?')[0]}`, 'api');
                
            } catch (error) {
                responseDiv.textContent = JSON.stringify({
                    error: error.message,
                    status: false,
                    timestamp: new Date().toISOString()
                }, null, 2);
                
                statusEl.textContent = 'Status: Network Error';
                timeEl.textContent = 'Time: --';
                
                addActivity(`API test failed: ${error.message}`, 'error');
            } finally {
                testBtn.innerHTML = originalText;
                testBtn.disabled = false;
            }
        }

        function copyApiUrl() {
            const select = document.getElementById('endpointSelect');
            const paramInput = document.getElementById('paramValue');
            let endpoint = select.value;
            
            if (!endpoint.includes('status') && !endpoint.includes('health') && !endpoint.includes('info') && paramInput.value.trim()) {
                endpoint += encodeURIComponent(paramInput.value);
            }
            
            const fullUrl = window.location.origin + endpoint;
            
            navigator.clipboard.writeText(fullUrl).then(() => {
                const btn = document.getElementById('copyUrlBtn');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="ri-check-line me-2"></i>Copied!';
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                }, 2000);
            });
        }

        // Activity Log
        function loadActivityLog() {
            const initialActivities = [
                { type: 'system', message: 'Dashboard v3.6.0 initialized', time: 'Just now' },
                { type: 'download', message: 'Threads downloader added', time: '2 minutes ago' },
                { type: 'ai', message: 'All AI models loaded successfully', time: '5 minutes ago' },
                { type: 'api', message: 'All API endpoints online', time: '10 minutes ago' },
                { type: 'download', message: 'YouTube video downloader working', time: '15 minutes ago' },
                { type: 'download', message: 'Spotify audio downloader ready', time: '20 minutes ago' }
            ];
            
            state.activities = initialActivities;
            renderActivityLog();
        }

        function addActivity(message, type) {
            const activity = {
                type: type,
                message: message,
                time: 'Just now',
                timestamp: new Date()
            };
            
            state.activities.unshift(activity);
            
            // Keep only last 10 activities
            if (state.activities.length > 10) {
                state.activities.pop();
            }
            
            renderActivityLog();
        }

        function renderActivityLog() {
            const container = document.getElementById('activityLog');
            let html = '';
            
            state.activities.forEach(activity => {
                let icon = 'ri-information-line';
                let color = 'primary';
                
                switch(activity.type) {
                    case 'ai': icon = 'ri-robot-line'; color = 'success'; break;
                    case 'download': icon = 'ri-download-cloud-line'; color = 'info'; break;
                    case 'api': icon = 'ri-code-s-slash-line'; color = 'warning'; break;
                    case 'error': icon = 'ri-error-warning-line'; color = 'danger'; break;
                    case 'system': icon = 'ri-server-line'; color = 'primary'; break;
                }
                
                html += `
                    <div class="activity-item">
                        <div class="activity-icon bg-${color}">
                            <i class="${icon}"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">${activity.message}</div>
                            <div class="activity-time">${activity.time}</div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Utility Functions
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
                
                // Close mobile menu if open
                if (window.innerWidth < 1200) {
                    document.getElementById('layout-menu').classList.remove('layout-menu-expanded');
                }
            }
        }

        function refreshDashboard() {
            const btn = document.getElementById('refreshBtn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<i class="ri-loader-4-line spin me-2"></i>Refreshing...';
            btn.disabled = true;
            
            // Refresh all data
            loadServerStatus();
            loadEndpointStatus();
            updateSystemMetrics();
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                addActivity('Dashboard refreshed', 'system');
            }, 1000);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('theme');
                window.location.href = 'index.html';
            }
        }

        // Add CSS for spinner animation
        const style = document.createElement('style');
        style.textContent = `
            .spin {
                animation: spin 1s linear infinite;
            }
            
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
        
        // Initialize
        updateParamPlaceholder();
    </script>
</body>
</html>
